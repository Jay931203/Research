#!/usr/bin/env node
/**
 * Enrich 3 SSM papers (HiPPO, S4, Mamba) in Supabase with comprehensive content.
 * Updates abstract, key_equations, architecture_detail, key_contributions,
 * algorithms, learning_objectives, self_check_questions, prerequisites.
 *
 * Run: node scripts/enrich-ssm-papers.mjs
 */

import fs from 'node:fs';
import path from 'node:path';
import { createClient } from '@supabase/supabase-js';

const ROOT = process.cwd();
const ENV_PATH = path.join(ROOT, '.env.local');

function loadEnv(filePath) {
  const env = {};
  if (!fs.existsSync(filePath)) return env;
  for (const line of fs.readFileSync(filePath, 'utf8').split(/\r?\n/)) {
    if (!line || line.trim().startsWith('#')) continue;
    const idx = line.indexOf('=');
    if (idx < 0) continue;
    const key = line.slice(0, idx).trim();
    let value = line.slice(idx + 1).trim();
    if ((value.startsWith('"') && value.endsWith('"')) ||
        (value.startsWith("'") && value.endsWith("'"))) {
      value = value.slice(1, -1);
    }
    env[key] = value;
  }
  return env;
}

const env = loadEnv(ENV_PATH);
const SUPABASE_URL = env.NEXT_PUBLIC_SUPABASE_URL;
const SUPABASE_KEY = env.NEXT_PUBLIC_SUPABASE_ANON_KEY;

if (!SUPABASE_URL || !SUPABASE_KEY) {
  console.error('âŒ .env.localì—ì„œ Supabase URL/Keyë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
  process.exit(1);
}

const supabase = createClient(SUPABASE_URL, SUPABASE_KEY);

// â”€â”€ Paper IDs â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const IDS = {
  HIPPO: 'dfbb4859-c5f9-4f47-8883-05ff0b8c6b27',
  S4:    '19db0bf1-9222-4dda-b783-d8622b67dcf9',
  MAMBA: 'c931dc29-9435-4b8f-a39d-5c16891ed705',
};

// â”€â”€ HiPPO enrichment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const HIPPO_UPDATE = {
  abstract: `ë³¸ ë…¼ë¬¸ì€ ìˆœì°¨ ë°ì´í„° í•™ìŠµì—ì„œ í•µì‹¬ ë¬¸ì œì¸ 'ì—°ì†ì ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ìž…ë ¥ì˜ ëˆ„ì  ì´ë ¥(history)ì„ ê³ ì • í¬ê¸°ì˜ ìƒíƒœ(state)ë¡œ ì–´ë–»ê²Œ ìµœì  ì••ì¶•í•  ê²ƒì¸ê°€'ë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ì—„ë°€í•˜ê²Œ í•´ê²°í•˜ëŠ” ì¼ë°˜ í”„ë ˆìž„ì›Œí¬ HiPPO(High-order Polynomial Projection Operators)ë¥¼ ì œì•ˆí•œë‹¤.

í•µì‹¬ ì•„ì´ë””ì–´ëŠ” ì‹œê°„ì— ë”°ë¼ ë³€í™”í•˜ëŠ” ì¸¡ë„(measure) Î¼^(t)ë¥¼ ì •ì˜í•˜ê³ , í•´ë‹¹ ì¸¡ë„ì— ëŒ€í•œ ì§êµ ë‹¤í•­ì‹ ê¸°ì €(orthogonal polynomial basis)ì— ìž…ë ¥ í•¨ìˆ˜ë¥¼ íˆ¬ì˜(projection)í•˜ì—¬ ìµœì ì˜ Nì°¨ ë‹¤í•­ì‹ ê·¼ì‚¬ ê³„ìˆ˜ c(t) âˆˆ â„^Nì„ ì˜¨ë¼ì¸ìœ¼ë¡œ ìœ ì§€í•˜ëŠ” ê²ƒì´ë‹¤. ì´ ê³„ìˆ˜ ì—…ë°ì´íŠ¸ê°€ ì„ í˜• ìƒë¯¸ë¶„ë°©ì •ì‹(ODE) dc/dt = A(t)c(t) + B(t)f(t)ë¡œ ê·€ê²°ë¨ì„ ì¦ëª…í•˜ê³ , ì „ì´í–‰ë ¬ A, Bì— ëŒ€í•œ ë‹«ížŒ í˜•íƒœ(closed-form)ë¥¼ ìœ ë„í•œë‹¤.

ë…¼ë¬¸ì€ ì„¸ ê°€ì§€ ì¸¡ë„ë¥¼ ì œì‹œí•œë‹¤: (1) HiPPO-LegT â€” ê³ ì • ê¸¸ì´ ìŠ¬ë¼ì´ë”© ìœˆë„ìš° [t-Î¸, t] ìœ„ì˜ ê· ì¼ ì¸¡ë„ë¡œ, ê¸°ì¡´ LMU(Legendre Memory Unit)ë¥¼ ì²« ì›ë¦¬ì—ì„œ ìž¬ìœ ë„í•œë‹¤. (2) HiPPO-LagT â€” ì§€ìˆ˜ ê°ì‡  ì¸¡ë„ e^{-(t-x)}ë¡œ, N=1ì¼ ë•Œ GRUì˜ ê²Œì´íŒ… ë©”ì»¤ë‹ˆì¦˜ê³¼ ë™ì¹˜ì´ë‹¤. (3) HiPPO-LegS â€” ì „ì²´ ì´ë ¥ [0, t] ìœ„ì˜ ê· ì¼ ì¸¡ë„ë¡œ, ì‹œê°„ ìŠ¤ì¼€ì¼ì— ëŒ€í•œ ì‚¬ì „ ê°€ì •ì´ í•„ìš” ì—†ëŠ” ìƒˆë¡œìš´ ë©”ëª¨ë¦¬ ì—…ë°ì´íŠ¸ì´ë‹¤.

íŠ¹ížˆ HiPPO-LegSëŠ” ì‹œê°„ ì²™ë„ ë“±ë³€ì„±(timescale equivariance), O(N) ì—°ì‚° ì—…ë°ì´íŠ¸, ë‹¤í•­ì‹ì  ê·¸ëž˜ë””ì–¸íŠ¸ ê°ì‡ (Î˜(1/t))ë¥¼ ë³´ìž¥í•˜ì—¬ ìž¥ê±°ë¦¬ ì˜ì¡´ì„± ëª¨ë¸ë§ì— ì´ë¡ ì  ìš°ìœ„ë¥¼ ê°€ì§„ë‹¤. LSTMì˜ ì§€ìˆ˜ì  ê·¸ëž˜ë””ì–¸íŠ¸ ì†Œì‹¤ ë¬¸ì œë¥¼ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°í•˜ë©°, Permuted MNISTì—ì„œ 98.3% ì •í™•ë„(ë‹¹ì‹œ RNN SOTA)ë¥¼ ë‹¬ì„±í–ˆë‹¤. HiPPO â†’ LSSL â†’ S4 â†’ S4D â†’ H3 â†’ Mambaë¡œ ì´ì–´ì§€ëŠ” State Space Model ê³„ë³´ì˜ ì¶œë°œì ì´ë‹¤.`,

  key_contributions: [
    'ì—°ì† ìž…ë ¥ ì´ë ¥ì„ ì§êµ ë‹¤í•­ì‹ ê¸°ì €ì— íˆ¬ì˜í•˜ì—¬ ê³ ì • í¬ê¸° ìƒíƒœë¡œ ìµœì  ì••ì¶•í•˜ëŠ” ì¼ë°˜ í”„ë ˆìž„ì›Œí¬ HiPPO(High-order Polynomial Projection Operators)ë¥¼ ì œì•ˆ',
    'íˆ¬ì˜ ê³„ìˆ˜ì˜ ì‹œê°„ ë³€í™”ê°€ ì„ í˜• ODE dc/dt = A(t)c(t) + B(t)f(t)ë¡œ ê·€ê²°ë¨ì„ ì¦ëª…í•˜ê³ , ì„¸ ê°€ì§€ ì¸¡ë„(LegT, LagT, LegS)ì— ëŒ€í•´ A, Bì˜ ë‹«ížŒ í˜•íƒœë¥¼ ìœ ë„',
    'ê¸°ì¡´ Legendre Memory Unit(LMU)ì´ HiPPO-LegTì˜ íŠ¹ìˆ˜ ê²½ìš°ìž„ì„ ì²« ì›ë¦¬ì—ì„œ ìž¬ìœ ë„í•˜ê³ , GRU ê²Œì´íŒ…ì´ HiPPO-LagTì˜ N=1 ê²½ìš°ìž„ì„ ì¦ëª…í•˜ì—¬ ê¸°ì¡´ ë©”ì»¤ë‹ˆì¦˜ì„ í†µí•©ì ìœ¼ë¡œ ì„¤ëª…',
    'ì „ ì´ë ¥ì— ê· ì¼ ì¸¡ë„ë¥¼ ë¶€ì—¬í•˜ëŠ” HiPPO-LegSë¥¼ ì œì•ˆ: ì‹œê°„ ì²™ë„ í•˜ì´í¼íŒŒë¼ë¯¸í„° ë¶ˆí•„ìš”, ìž…ë ¥ ì‹œê°„ ì¶• ì‹ ì¶•ì— ëŒ€í•œ ë“±ë³€ì„±(timescale equivariance) ë³´ìž¥',
    'HiPPO-LegSì˜ ê·¸ëž˜ë””ì–¸íŠ¸ ë…¸ë¦„ì´ Î˜(1/t)ë¡œ ë‹¤í•­ì‹ì  ê°ì‡ í•¨ì„ ì¦ëª… â€” ê¸°ì¡´ RNNì˜ ì§€ìˆ˜ì  ê·¸ëž˜ë””ì–¸íŠ¸ ì†Œì‹¤ ë¬¸ì œë¥¼ ê·¼ë³¸ì ìœ¼ë¡œ í•´ê²°',
    'ìŒì„ í˜• ì´ì‚°í™” í•˜ì—ì„œ HiPPO-LegS ì—…ë°ì´íŠ¸ê°€ O(N) ì—°ì‚°ìœ¼ë¡œ ê°€ëŠ¥í•¨ì„ ì¦ëª… (í‘œì¤€ RNN O(NÂ²) ëŒ€ë¹„ íš¨ìœ¨ì )',
    'Permuted MNIST 98.3%(ë‹¹ì‹œ RNN SOTA), 100ë§Œ íƒ€ìž„ìŠ¤í… í•¨ìˆ˜ ìž¬êµ¬ì„±ì—ì„œ LSTM ëŒ€ë¹„ 12ë°° ìš°ìˆ˜í•œ MSE ë‹¬ì„±',
    'ì‹œê°„ ì²™ë„ ì¼ë°˜í™”: í•™ìŠµ ì‹œì™€ ë‹¤ë¥¸ ìƒ˜í”Œë§ ë ˆì´íŠ¸(100Hzâ†’200Hz)ì—ì„œ 88.8% ì •í™•ë„ ìœ ì§€ (LSTM: 25.4%)',
    'S4, S4D, H3, Mambaë¡œ ì´ì–´ì§€ëŠ” State Space Model ê³„ë³´ì˜ ì´ë¡ ì  ê¸°ë°˜ í™•ë¦½',
  ],

  algorithms: [
    'HiPPO-LegS (Scaled Legendre): ì „ì²´ ì´ë ¥ [0,t] ê· ì¼ ì¸¡ë„, ì‹œë³€ ODE, ì‹œê°„ ì²™ë„ ë“±ë³€ì„±',
    'HiPPO-LegT (Translated Legendre): ìŠ¬ë¼ì´ë”© ìœˆë„ìš° [t-Î¸,t] ê· ì¼ ì¸¡ë„, ì‹œë¶ˆë³€ SSM, LMU ìž¬ìœ ë„',
    'HiPPO-LagT (Translated Laguerre): ì§€ìˆ˜ ê°ì‡  ì¸¡ë„, ì‹œë¶ˆë³€ SSM, GRU/LSTM ê²Œì´íŒ… ì¼ë°˜í™”',
    'ìŒì„ í˜• ì´ì‚°í™” (Bilinear Transform): ì•ˆì •ì„± ë³´ì¡´, O(N) ì‚¼ê° ì‹œìŠ¤í…œ í’€ì´',
    'ì „ì§„ ì˜¤ì¼ëŸ¬ ì´ì‚°í™” (Forward Euler): ë‹¨ìˆœí•˜ì§€ë§Œ ìˆ˜ì¹˜ ë¶ˆì•ˆì •',
    'ì˜ì°¨ í™€ë“œ ì´ì‚°í™” (ZOH): ì—°ì† ì‹ í˜¸ ìƒìˆ˜ ê°€ì •, í›„ì† S4/Mambaì—ì„œ í‘œì¤€ ì‚¬ìš©',
  ],

  key_equations: [
    {
      name: 'HiPPO íˆ¬ì˜ ì—°ì‚°ìž ì •ì˜',
      latex: '\\operatorname{hippo}(f) = \\operatorname{coef}_t \\circ \\operatorname{proj}_t(f_{\\leq t}), \\quad g^{(t)} = \\operatorname*{arg\\,min}_{g \\in \\mathcal{G}} \\| f_{\\leq t} - g \\|_{L^2(\\mu^{(t)})}',
      description: 'HiPPOì˜ í•µì‹¬ ì •ì˜. ì‹œê°„ tì—ì„œ ì¸¡ë„ Î¼^(t)ì— ëŒ€í•œ L2 ìµœì  ë‹¤í•­ì‹ ê·¼ì‚¬ë¥¼ êµ¬í•˜ê³ (proj), ì§êµ ë‹¤í•­ì‹ ê¸°ì €ì— ëŒ€í•œ ê³„ìˆ˜ë¥¼ ì¶”ì¶œ(coef)í•œë‹¤.',
    },
    {
      name: 'HiPPO ODE (ì£¼ ì •ë¦¬)',
      latex: '\\frac{d}{dt} c(t) = A(t)\\, c(t) + B(t)\\, f(t)',
      description: 'Theorem 1ì˜ í•µì‹¬ ê²°ê³¼. ì§êµ ë‹¤í•­ì‹ íˆ¬ì˜ ê³„ìˆ˜ c(t)ì˜ ì‹œê°„ ë³€í™”ê°€ ìž…ë ¥ f(t)ì— ëŒ€í•œ ì„ í˜• ODEë¡œ ê·€ê²°ëœë‹¤. A(t)ì™€ B(t)ëŠ” ì¸¡ë„ ì„ íƒì— ë”°ë¼ ë‹«ížŒ í˜•íƒœë¡œ ì£¼ì–´ì§„ë‹¤.',
    },
    {
      name: 'HiPPO-LegS í–‰ë ¬ A (Scaled Legendre)',
      latex: 'A_{nk} = \\begin{cases} (2n+1)^{1/2}(2k+1)^{1/2} & n > k \\\\ n+1 & n = k \\\\ 0 & n < k \\end{cases}',
      description: 'í•˜ì‚¼ê° í–‰ë ¬. ê³ ìœ ê°’ì€ {1, 2, ..., N}ì´ê³ , ê° ëª¨ë“œì˜ ê°ì‡ ìœ¨ì´ ë‹¤ë¥´ë©° ì¸ê³¼ì  ì •ë³´ íë¦„ì„ ë³´ìž¥í•œë‹¤. 0-ê¸°ë°˜ ì¸ë±ì‹±(n,k = 0,...,N-1).',
    },
    {
      name: 'HiPPO-LegS ë²¡í„° B ë° ì‹œë³€ ODE',
      latex: 'B_n = (2n+1)^{1/2}, \\qquad \\frac{d}{dt}c(t) = -\\frac{1}{t}A\\,c(t) + \\frac{1}{t}B\\,f(t)',
      description: '1/t ìŠ¤ì¼€ì¼ë§ì´ í•µì‹¬: ì¸¡ë„ê°€ [0,t] ì „ì²´ì— ê· ì¼í•˜ê¸° ë•Œë¬¸. ì‹œê°„ì´ ì§€ë‚¨ì— ë”°ë¼ ì—…ë°ì´íŠ¸ í¬ê¸°ê°€ ìžì—°ìŠ¤ëŸ½ê²Œ ì¤„ì–´ë“¤ì–´ ê³¼ê±° ì •ë³´ê°€ ì ì§„ì ìœ¼ë¡œ ë³´ì¡´ëœë‹¤.',
    },
    {
      name: 'HiPPO-LegT í–‰ë ¬ A, B (Translated Legendre)',
      latex: 'A_{nk} = \\frac{1}{\\theta}\\begin{cases} (-1)^{n-k}(2n+1) & n \\geq k \\\\ (2n+1) & n < k \\end{cases}, \\quad B_n = \\frac{(2n+1)(-1)^n}{\\theta}',
      description: 'ìŠ¬ë¼ì´ë”© ìœˆë„ìš° [t-Î¸, t] ê· ì¼ ì¸¡ë„ì— ëŒ€ì‘. LMUë¥¼ ì²« ì›ë¦¬ì—ì„œ ìž¬ìœ ë„í•œ ê²°ê³¼. ì‹œë¶ˆë³€ì´ë¯€ë¡œ í‘œì¤€ ì´ì‚°í™”ê°€ ì§ì ‘ ì ìš© ê°€ëŠ¥.',
    },
    {
      name: 'HiPPO-LagT í–‰ë ¬ A, B (Translated Laguerre)',
      latex: 'A_{nk} = \\begin{cases} 1 & n \\geq k \\\\ 0 & n < k \\end{cases}, \\quad B_n = 1',
      description: 'ì§€ìˆ˜ ê°ì‡  ì¸¡ë„ e^{-(t-x)}ì— ëŒ€ì‘. N=1 ì´ì‚°í™” ì‹œ c_{t+1} = (1-Î”t)c_t + Î”tÂ·f_t â†’ GRU ê²Œì´íŒ…ê³¼ ë™ì¹˜.',
    },
    {
      name: 'HiPPO-LegS ì´ì‚°í™” (ìž¬ê·€ì‹)',
      latex: 'c_{k+1} = \\left(1 - \\frac{A}{k}\\right) c_k + \\frac{1}{k} B\\, f_k',
      description: 'ì „ì§„ ì˜¤ì¼ëŸ¬ ì´ì‚°í™”í•œ ìž¬ê·€ì‹. ì‹œê°„ ì¸ë±ìŠ¤ kì— ë”°ë¼ ì „ì´í–‰ë ¬ì´ ë³€í•˜ëŠ” ì‹œë³€ ì‹œìŠ¤í…œ.',
    },
    {
      name: 'ê·¸ëž˜ë””ì–¸íŠ¸ ê²½ê³„ (ë‹¤í•­ì‹ vs ì§€ìˆ˜ ê°ì‡ )',
      latex: '\\text{HiPPO-LegS: } \\left\\| \\frac{\\partial c(t_1)}{\\partial f(t_0)} \\right\\| = \\Theta\\!\\left(\\frac{1}{t_1}\\right), \\quad \\text{ê¸°ì¡´ RNN: } \\left\\| \\frac{\\partial h_{t_1}}{\\partial h_{t_0}} \\right\\| \\leq \\lambda^{t_1 - t_0}',
      description: 'Proposition 5. HiPPO-LegS ê·¸ëž˜ë””ì–¸íŠ¸ëŠ” ë‹¤í•­ì‹ì (1/t) ê°ì‡ , ê¸°ì¡´ RNNì€ ì§€ìˆ˜ì  ì†Œì‹¤. ìž¥ê±°ë¦¬ ì˜ì¡´ì„± í•™ìŠµì—ì„œ ê·¼ë³¸ì  ì´ì .',
    },
    {
      name: 'ì‹œê°„ ì²™ë„ ë“±ë³€ì„± (Timescale Equivariance)',
      latex: '\\operatorname{hippo}_{\\text{LegS}}(f \\circ \\gamma) = \\operatorname{hippo}_{\\text{LegS}}(f) \\circ \\gamma, \\quad \\gamma(t) = \\alpha t',
      description: 'Proposition 3. ìž…ë ¥ì„ ì‹œê°„ì¶• Î±ë°° ì‹ ì¶•í•´ë„ ì¶œë ¥ì´ ë™ì¼í•˜ê²Œ ì‹ ì¶•. ì´ì‚°í™” ìŠ¤í… Î”t í•˜ì´í¼íŒŒë¼ë¯¸í„° íŠœë‹ ë¶ˆí•„ìš”, ë‹¤ë¥¸ ìƒ˜í”Œë§ ë ˆì´íŠ¸ì—ì„œ ì¼ë°˜í™” ê°€ëŠ¥.',
    },
    {
      name: 'ê·¼ì‚¬ ì˜¤ì°¨ ê²½ê³„',
      latex: '\\| f_{\\leq t} - g^{(t)} \\|_{L^2(\\mu^{(t)})} = O\\!\\left( \\frac{tL}{\\sqrt{N}} \\right)',
      description: 'Proposition 6. L-ë¦½ì‹œì¸  í•¨ìˆ˜ì— ëŒ€í•´ N-1ì°¨ ë‹¤í•­ì‹ ê·¼ì‚¬ì˜ L2 ì˜¤ì°¨ ìƒê³„. Nì„ í‚¤ìš°ë©´ 1/âˆšNìœ¼ë¡œ ê°ì†Œí•˜ì—¬ ì²´ê³„ì  ì •í™•ë„ ê°œì„  ê°€ëŠ¥.',
    },
  ],

  architecture_detail: `## 1) íˆ¬ì˜ ì—°ì‚°ìž í”„ë ˆìž„ì›Œí¬

HiPPOì˜ ì¶œë°œì ì€ í•¨ìˆ˜ ê·¼ì‚¬ ì´ë¡ ì´ë‹¤. ì‹œê°„ tì—ì„œ ê´€ì¸¡ëœ ìž…ë ¥ ì´ë ¥ f(s), s âˆˆ [0,t]ë¥¼ Nì°¨ ë‹¤í•­ì‹ ê³µê°„ì— íˆ¬ì˜í•˜ì—¬ ìµœì  ê·¼ì‚¬ë¥¼ êµ¬í•œë‹¤. ê²°ê³¼ c(t) âˆˆ â„^Nì€ ì§êµ ë‹¤í•­ì‹ ê¸°ì €ì— ëŒ€í•œ ê³„ìˆ˜ ë²¡í„°ì´ë©°, ì´ê²ƒì´ "ë©”ëª¨ë¦¬ ìƒíƒœ"ê°€ ëœë‹¤. ì¸¡ë„ Î¼^(t)ëŠ” "ê³¼ê±°ì˜ ì–´ëŠ ì‹œì ì´ í˜„ìž¬ì— ì–¼ë§ˆë‚˜ ì¤‘ìš”í•œê°€"ë¥¼ ì¸ì½”ë”©í•˜ëŠ” ê°€ì¤‘ í•¨ìˆ˜ì´ë‹¤.

## 2) ì¸¡ë„ ì„ íƒê³¼ ë©”ëª¨ë¦¬ íŠ¹ì„±

**HiPPO-LegT (ìŠ¬ë¼ì´ë”© ìœˆë„ìš°):** Î¼^(t) = (1/Î¸)Â·ð•€_{[t-Î¸, t]}, ìµœê·¼ Î¸ ì‹œê°„ ë‚´ì˜ ì´ë ¥ì—ë§Œ ê· ì¼ ê°€ì¤‘. ìœˆë„ìš° ë°– ì •ë³´ëŠ” ìžŠí˜€ì§„ë‹¤. LMUì™€ ì •í™•ížˆ ë™ì¹˜ì´ë©°, ì‹œë¶ˆë³€ì´ë¯€ë¡œ í‘œì¤€ SSMìœ¼ë¡œ ì§ì ‘ ì‚¬ìš© ê°€ëŠ¥.

**HiPPO-LagT (ì§€ìˆ˜ ê°ì‡ ):** Î¼^(t) = e^{-(t-x)}, ìµœê·¼ ìž…ë ¥ì— ë†’ì€ ê°€ì¤‘ì¹˜. ì—­ì‹œ ì‹œë¶ˆë³€. N=1ë¡œ ì¶•ì†Œí•˜ë©´ ë‹¨ìˆœ EMAê°€ ë˜ê³ , ì´ì‚°í™”í•˜ë©´ GRU ê²Œì´íŠ¸ì™€ êµ¬ì¡°ì ìœ¼ë¡œ ë™ì¼. ì¦‰ ê²Œì´íŒ…ì€ 1ì°¨ Laguerre ë‹¤í•­ì‹ íˆ¬ì˜ì˜ íŠ¹ìˆ˜ ê²½ìš°.

**HiPPO-LegS (ì „ ì´ë ¥ ê· ì¼):** Î¼^(t) = (1/t)Â·ð•€_{[0, t]}, ì „ì²´ ì´ë ¥ì— ê· ì¼í•œ ê°€ì¤‘. ì¸¡ë„ ì§€ì§€ê°€ í™•ìž¥ë˜ë¯€ë¡œ ì‹œë³€ ì‹œìŠ¤í…œ. ì´ ì„¤ì •ë§Œì´ ì‹œê°„ ì²™ë„ ë“±ë³€ì„±ì„ ë§Œì¡±.

## 3) ì˜¨ë¼ì¸ ê³„ìˆ˜ ì—…ë°ì´íŠ¸ ë©”ì»¤ë‹ˆì¦˜

í•µì‹¬ ìˆ˜í•™ì  ê²°ê³¼(Theorem 1, 2)ëŠ” íˆ¬ì˜ ê³„ìˆ˜ c(t)ê°€ ì„ í˜• ODEë¥¼ ë§Œì¡±í•œë‹¤ëŠ” ê²ƒ: dc/dt = A(t)c(t) + B(t)f(t). ì´ ODEëŠ” ìž…ë ¥ f(t)ì— ëŒ€í•´ ì„ í˜•ì´ë¯€ë¡œ, ìƒˆë¡œìš´ ìž…ë ¥ì´ ë“¤ì–´ì˜¬ ë•Œ ê¸°ì¡´ ê³„ìˆ˜ë¥¼ A(t)ë¡œ íšŒì „/ìŠ¤ì¼€ì¼ë§í•˜ê³  B(t)Â·f(t)ë¥¼ ë”í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œ ìµœì  íˆ¬ì˜ì´ ìœ ì§€ëœë‹¤.

ì´ì‚°í™” ë°©ë²•: (1) ì „ì§„ ì˜¤ì¼ëŸ¬: ë‹¨ìˆœí•˜ì§€ë§Œ ë¶ˆì•ˆì • ê°€ëŠ¥. (2) ìŒì„ í˜• ë³€í™˜: ìˆ˜ì¹˜ ì•ˆì •ì„± ìš°ìˆ˜. (3) ì˜ì°¨ í™€ë“œ(ZOH): SSM ë¬¸ë§¥ì—ì„œ í‘œì¤€.

## 4) ì„ í˜• ODEì™€ SSMì˜ ì—°ê²°

HiPPO ODEëŠ” ë³¸ì§ˆì ìœ¼ë¡œ ì—°ì† ì‹œê°„ ì„ í˜• SSMì´ë‹¤. LegT, LagTëŠ” ì‹œë¶ˆë³€ì´ë¯€ë¡œ ë°”ë¡œ SSMìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥. S4ì—ì„œëŠ” HiPPO-LegS í–‰ë ¬ì˜ NPLR ë¶„í•´ë¥¼ SSM A í–‰ë ¬ ì´ˆê¸°í™”ì— ì‚¬ìš©í–ˆìœ¼ë©°, ì´ê²ƒë§Œìœ¼ë¡œ Sequential MNIST ì •í™•ë„ê°€ 60%â†’98%ë¡œ ë„ì•½í–ˆë‹¤.

## 5) A í–‰ë ¬ êµ¬ì¡°ê°€ ê²°ì •í•˜ëŠ” ë©”ëª¨ë¦¬ ì—­í•™

A í–‰ë ¬ì˜ ê³ ìœ ê°’ ë¶„í¬ê°€ ë©”ëª¨ë¦¬ì˜ ì‹œê°„ì  íŠ¹ì„±ì„ ê²°ì •í•œë‹¤. LegS: ê³ ìœ ê°’ {1,...,N}ìœ¼ë¡œ ë‹¤ì¤‘ ì‹œê°„ ìŠ¤ì¼€ì¼ í¬ì°©. LagT: ê³ ìœ ê°’ ëª¨ë‘ 1ë¡œ ê· ì¼ ê°ì‡ . LegT: êµëŒ€ ë¶€í˜¸ êµ¬ì¡°ë¡œ ìœˆë„ìš° ê²½ê³„ ì‹ í˜¸ í¬ì°©. í•˜ì‚¼ê° êµ¬ì¡°ëŠ” ì¸ê³¼ì  ì •ë³´ ì²˜ë¦¬ë¥¼ ë³´ìž¥í•˜ë©°, ëŒ€ê°í™” ê°€ëŠ¥ì„±ì€ í›„ì† S4 ê³„ì—´ì˜ íš¨ìœ¨ì  ê³„ì‚°(FFT ê¸°ë°˜)ì˜ ê¸°ë°˜ì´ ë˜ì—ˆë‹¤.`,

  prerequisites: [
    'ì„ í˜•ëŒ€ìˆ˜í•™: í–‰ë ¬ ê³±ì…ˆ, ê³ ìœ ê°’/ê³ ìœ ë²¡í„°, ì‚¼ê° í–‰ë ¬, ëŒ€ê°í™”',
    'ë¯¸ë¶„ë°©ì •ì‹: ìƒë¯¸ë¶„ë°©ì •ì‹(ODE), ì„ í˜• ì‹œìŠ¤í…œ dx/dt = Ax + Buì˜ í•´',
    'í•¨ìˆ˜ í•´ì„: L2 ê³µê°„, ë‚´ì , ì§êµ íˆ¬ì˜, ìµœì  ê·¼ì‚¬',
    'ì§êµ ë‹¤í•­ì‹: Legendre ë‹¤í•­ì‹, Laguerre ë‹¤í•­ì‹, ì§êµì„± ì¡°ê±´',
    'ì¸¡ë„ë¡  ê¸°ì´ˆ: ì¸¡ë„(measure), ê°€ì¤‘ ë‚´ì , í•¨ìˆ˜ ê³µê°„ì—ì„œì˜ L2 ë…¸ë¦„',
    'ìˆ˜ì¹˜ í•´ì„: ODE ì´ì‚°í™” (Forward Euler, Bilinear Transform, ZOH)',
    'RNN ê¸°ì´ˆ: ìˆœí™˜ ì‹ ê²½ë§, BPTT, ê·¸ëž˜ë””ì–¸íŠ¸ ì†Œì‹¤/í­ë°œ ë¬¸ì œ',
    'ê²Œì´íŠ¸ ë©”ì»¤ë‹ˆì¦˜: GRU/LSTMì˜ ê²Œì´íŠ¸ ì—…ë°ì´íŠ¸ ê·œì¹™',
    'ìƒíƒœ ê³µê°„ ëª¨ë¸(SSM): ì—°ì†/ì´ì‚° ì‹œê°„ LTI ì‹œìŠ¤í…œ, ì „ë‹¬ í•¨ìˆ˜',
  ],

  learning_objectives: [
    'ìˆœì°¨ ë°ì´í„°ì—ì„œ ì—°ì† ìž…ë ¥ ì´ë ¥ì„ ê³ ì • í¬ê¸° ìƒíƒœë¡œ ì••ì¶•í•˜ëŠ” ë¬¸ì œë¥¼ ìˆ˜í•™ì ìœ¼ë¡œ ì •ì‹í™”í•  ìˆ˜ ìžˆë‹¤',
    'ì¸¡ë„ ì„ íƒì´ ë©”ëª¨ë¦¬ ë©”ì»¤ë‹ˆì¦˜ì˜ ì‹œê°„ì  íŠ¹ì„±(ìŠ¬ë¼ì´ë”© ìœˆë„ìš°, ì§€ìˆ˜ ê°ì‡ , ì „ ì´ë ¥ ê· ì¼)ì„ ì–´ë–»ê²Œ ê²°ì •í•˜ëŠ”ì§€ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'HiPPO ODEì˜ ì˜ë¯¸ë¥¼ í•´ì„í•˜ê³  ì „ì´í–‰ë ¬ Aì˜ êµ¬ì¡°ê°€ ë©”ëª¨ë¦¬ ì—­í•™ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ë¶„ì„í•  ìˆ˜ ìžˆë‹¤',
    'HiPPO-LegS, LegT, LagT ì„¸ ë³€í˜•ì˜ í–‰ë ¬ A, Bë¥¼ ê¸°ìˆ í•˜ê³  ê°ê°ì˜ ì¸¡ë„ ë° íŠ¹ì„±ì„ ë¹„êµí•  ìˆ˜ ìžˆë‹¤',
    'HiPPO-LegSì˜ ì‹œê°„ ì²™ë„ ë“±ë³€ì„± ì„±ì§ˆê³¼ ìž¥ê±°ë¦¬ ì˜ì¡´ì„± ëª¨ë¸ë§ì—ì˜ ìœ ë¦¬í•¨ì„ ë…¼ì¦í•  ìˆ˜ ìžˆë‹¤',
    'ë‹¤í•­ì‹ì  ê·¸ëž˜ë””ì–¸íŠ¸ ê°ì‡ (Î˜(1/t))ì™€ ì§€ìˆ˜ì  ì†Œì‹¤ì˜ ì°¨ì´ë¥¼ ì´í•´í•˜ê³  HiPPOì˜ í•´ê²° ë°©ì‹ì„ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'GRU ê²Œì´íŒ…ì´ HiPPO-LagTì˜ N=1 íŠ¹ìˆ˜ ê²½ìš°ìž„ì„ ìœ ë„í•  ìˆ˜ ìžˆë‹¤',
    'ì—°ì† ì‹œê°„ ODEë¥¼ ì´ì‚° ìž¬ê·€ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ì´ì‚°í™” ê¸°ë²•ì„ ì ìš©í•  ìˆ˜ ìžˆë‹¤',
    'HiPPOê°€ í›„ì† ì—°êµ¬(LSSL â†’ S4 â†’ Mamba)ì—ì„œì˜ ì—­í• ì„ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
  ],

  self_check_questions: [
    'HiPPOì—ì„œ ì¸¡ë„ Î¼^(t)ì˜ ì—­í• ì€ ë¬´ì—‡ì´ë©°, ì™œ ì¸¡ë„ ì„ íƒì´ ë©”ëª¨ë¦¬ íŠ¹ì„±ì„ ê²°ì •í•˜ëŠ”ê°€?',
    'HiPPO-LegSì˜ A í–‰ë ¬ì´ í•˜ì‚¼ê° êµ¬ì¡°ë¥¼ ê°€ì§€ëŠ” ì´ìœ ë¥¼ ì§êµ ë‹¤í•­ì‹ì˜ ì„±ì§ˆê³¼ ì—°ê²°í•˜ì—¬ ì„¤ëª…í•˜ë¼.',
    'HiPPO-LegS ODEì—ì„œ 1/t ìŠ¤ì¼€ì¼ë§ì´ ë‚˜íƒ€ë‚˜ëŠ” ì´ìœ ëŠ”? ì‹œê°„ ì²™ë„ ë“±ë³€ì„±ê³¼ì˜ ì—°ê²°ì€?',
    'HiPPO-LagTë¥¼ N=1ë¡œ ì¶•ì†Œí•˜ê³  ì´ì‚°í™”í•˜ë©´ GRU ê²Œì´íŒ…ê³¼ ë™ì¼í•´ì§ì„ ìˆ˜ì‹ìœ¼ë¡œ ë³´ì—¬ë¼.',
    'HiPPO-LegSì˜ ê·¸ëž˜ë””ì–¸íŠ¸ Î˜(1/t) ê°ì‡ ì™€ ê¸°ì¡´ RNNì˜ Î»^(t1-t0) ì§€ìˆ˜ ê°ì‡ ë¥¼ ë¹„êµí•˜ë¼. 100ë§Œ ìŠ¤í…ì—ì„œ ì°¨ì´ëŠ”?',
    'HiPPO-LegTì™€ LMUì˜ ê´€ê³„ë¥¼ ì„¤ëª…í•˜ê³ , ìœˆë„ìš° í¬ê¸° Î¸ê°€ í•˜ì´í¼íŒŒë¼ë¯¸í„°ì¸ ê²ƒì´ ì™œ LegS ëŒ€ë¹„ ë‹¨ì ì¸ì§€ ë…¼í•˜ë¼.',
    'Forward Eulerì™€ Bilinear Transform ì´ì‚°í™”ì˜ ìˆ˜ì¹˜ì  ì•ˆì •ì„± ì°¨ì´ë¥¼ ì„¤ëª…í•˜ë¼.',
    'S4ì—ì„œ HiPPO í–‰ë ¬ë¡œ Aë¥¼ ì´ˆê¸°í™”í•˜ë©´ Sequential MNIST 60%â†’98% í–¥ìƒë˜ëŠ” ì´ìœ ë¥¼ HiPPO ì´ë¡ ìœ¼ë¡œ ì„¤ëª…í•˜ë¼.',
    'HiPPO-LegSëŠ” ìƒíƒœ ì°¨ì› Nì„ ëŠ˜ë¦¬ë©´ ê·¼ì‚¬ ì˜¤ì°¨ê°€ O(1/âˆšN)ìœ¼ë¡œ ê°ì†Œí•œë‹¤. N=256ê³¼ N=16 ì„±ëŠ¥ ì°¨ì´ë¥¼ ì˜ˆìƒí•´ ë³´ë¼.',
    'HiPPOì—ì„œ Mambaê¹Œì§€ì˜ ê³„ë³´(HiPPOâ†’LSSLâ†’S4â†’S4Dâ†’H3â†’Mamba)ì—ì„œ ê° ë‹¨ê³„ê°€ í•´ê²°í•œ í•µì‹¬ ë¬¸ì œëŠ”?',
  ],
};

// â”€â”€ S4 enrichment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const S4_UPDATE = {
  abstract: `S4(Structured State Spaces for Sequences)ëŠ” ìƒíƒœ ê³µê°„ ëª¨ë¸(SSM)ì„ ë”¥ëŸ¬ë‹ì˜ ì‹œí€€ìŠ¤ ëª¨ë¸ë§ì— ì‹¤ìš©ì ìœ¼ë¡œ ì ìš©í•˜ê¸° ìœ„í•œ í•µì‹¬ ë‚œì œë“¤ì„ í•´ê²°í•œ íšê¸°ì ì¸ ì—°êµ¬ì´ë‹¤. ê¸°ì¡´ SSMì€ ì—°ì† ì‹œê°„ ë™ì—­í•™ ì‹œìŠ¤í…œ x'(t) = Ax(t) + Bu(t)ì— ê¸°ë°˜í•˜ì—¬ ì´ë¡ ì ìœ¼ë¡œëŠ” ë¬´í•œí•œ ìž¥ê±°ë¦¬ ì˜ì¡´ì„±ì„ í¬ì°©í•  ìˆ˜ ìžˆì§€ë§Œ, ìƒíƒœ ì°¨ì› Nê³¼ ì‹œí€€ìŠ¤ ê¸¸ì´ Lì— ëŒ€í•´ O(NÂ²L)ì˜ ê³„ì‚° ë³µìž¡ë„ë¡œ ì¸í•´ ë”¥ëŸ¬ë‹ ê·œëª¨ì—ì„œëŠ” ì‹¤ìš©ì ì´ì§€ ëª»í–ˆë‹¤.

S4ì˜ ì²« ë²ˆì§¸ í•µì‹¬ í†µì°°ì€ SSMì´ ì„¸ ê°€ì§€ ë™ì¹˜ í‘œí˜„ì„ ê°–ëŠ”ë‹¤ëŠ” ê²ƒì´ë‹¤: (1) ì—°ì† ì‹œê°„ ë¯¸ë¶„ë°©ì •ì‹, (2) ì´ì‚° ìˆœí™˜(RNNê³¼ ìœ ì‚¬í•œ ìž¬ê·€), (3) ì „ì—­ í•©ì„±ê³±. í•™ìŠµ ì‹œì—ëŠ” í•©ì„±ê³± ëª¨ë“œë¡œ FFTë¥¼ í™œìš©í•œ O(L log L) ë³‘ë ¬ í•™ìŠµì´ ê°€ëŠ¥í•˜ê³ , ì¶”ë¡  ì‹œì—ëŠ” ìˆœí™˜ ëª¨ë“œë¡œ ì „í™˜í•˜ì—¬ O(1) ìƒìˆ˜ ì‹œê°„ ìŠ¤í…ë³„ ìƒì„±ì´ ê°€ëŠ¥í•˜ë‹¤.

ë‘ ë²ˆì§¸ í•µì‹¬ ê¸°ì—¬ëŠ” NPLR(Normal Plus Low-Rank) ë¶„í•´ì´ë‹¤. HiPPO í–‰ë ¬ Aë¥¼ A = VÎ›V* - PQ^T í˜•íƒœë¡œ ë¶„í•´í•˜ë©´, í•©ì„±ê³± ì»¤ë„ ê³„ì‚°ì´ Cauchy ì»¤ë„ í‰ê°€ ë¬¸ì œë¡œ í™˜ì›ëœë‹¤. ì´ë¥¼ í†µí•´ O(NÂ²L)ì—ì„œ Ã•(N+L)ë¡œ ê³„ì‚° ë³µìž¡ë„ë¥¼ ê·¹ì ìœ¼ë¡œ ì¤„ì¸ë‹¤.

S4ëŠ” Long Range Arena(LRA) ë²¤ì¹˜ë§ˆí¬ì˜ ëª¨ë“  6ê°œ íƒœìŠ¤í¬ì—ì„œ SOTAë¥¼ ë‹¬ì„±í–ˆìœ¼ë©°, íŠ¹ížˆ ì´ì „ ëª¨ë“  ëª¨ë¸ì´ ëžœë¤ ì¶”ì¸¡(50%) ìˆ˜ì¤€ì— ë¨¸ë¬¼ë €ë˜ Path-X íƒœìŠ¤í¬(ì‹œí€€ìŠ¤ ê¸¸ì´ 16,384)ë¥¼ ìµœì´ˆë¡œ í•´ê²°í–ˆë‹¤. Sequential CIFAR-10ì—ì„œ 91%, Speech Commandsì—ì„œ 98.3%ë¥¼ ë‹¬ì„±í•˜ê³ , WikiText-103ì—ì„œ Transformer ëŒ€ë¹„ 0.8 PPL ì°¨ì´ë¡œ ê±°ì˜ ë™ë“±í•œ ì„±ëŠ¥ì„ ë³´ì´ë©´ì„œ 60ë°° ë¹ ë¥¸ ìƒì„± ì†ë„ë¥¼ ê¸°ë¡í–ˆë‹¤.`,

  venue: 'ICLR 2022 (Oral, Outstanding Paper Honorable Mention)',

  key_contributions: [
    'ìµœì´ˆì˜ ì‹¤ìš©ì  êµ¬ì¡°í™” ìƒíƒœ ê³µê°„ ëª¨ë¸(S4): SSMì˜ ì´ë¡ ì  ìž¥ì ì„ ìœ ì§€í•˜ë©´ì„œ ë”¥ëŸ¬ë‹ ê·œëª¨ì—ì„œ í•™ìŠµÂ·ì¶”ë¡ ì´ ê°€ëŠ¥í•œ íš¨ìœ¨ì  íŒŒë¼ë¯¸í„°í™” ì œì•ˆ',
    'ì´ì¤‘ ê³„ì‚° ëª¨ë“œ: í•™ìŠµ ì‹œ í•©ì„±ê³±(FFT O(L log L)), ì¶”ë¡  ì‹œ ìˆœí™˜(O(1) ìŠ¤í…ë‹¹) ëª¨ë“œì˜ ë§¤ë„ëŸ¬ìš´ ì „í™˜',
    'NPLR(Normal Plus Low-Rank) ë¶„í•´ ì •ë¦¬: ëª¨ë“  HiPPO í–‰ë ¬ì´ A = VÎ›V* âˆ’ PQ^T í˜•íƒœë¥¼ ê°€ì§ì„ ì¦ëª… (ëž­í¬ r â‰¤ 2)',
    'Cauchy ì»¤ë„ í™˜ì›: NPLR â†’ DPLR + Woodbury í•­ë“±ì‹ìœ¼ë¡œ SSM ì»¤ë„ ê³„ì‚°ì„ O(NÂ²L)ì—ì„œ Ã•(N+L)ë¡œ ê°ì†Œ',
    'Long Range Arena ë²¤ì¹˜ë§ˆí¬ ì „ íƒœìŠ¤í¬ SOTA: í‰ê·  ~86%, ëª¨ë“  efficient Transformer ë³€í˜•ì„ ëŠ¥ê°€',
    'Path-X íƒœìŠ¤í¬ ìµœì´ˆ í•´ê²°: ì‹œí€€ìŠ¤ ê¸¸ì´ 16,384ì˜ ê²½ë¡œ ì—°ê²° íŒë³„ ë¬¸ì œë¥¼ ~96% ì •í™•ë„ë¡œ í•´ê²°',
    'Sequential CIFAR-10ì—ì„œ 91% ì •í™•ë„: ë°ì´í„° ì¦ê°• ì—†ì´ 2D ResNetê³¼ ë™ë“±í•œ ìˆ˜ì¤€ì„ 1D ì‹œí€€ìŠ¤ë¡œ ë‹¬ì„±',
    'WikiText-103ì—ì„œ Transformer ëŒ€ë¹„ 0.8 PPL ì°¨ì´ + ìžê¸°íšŒê·€ ìƒì„± ì†ë„ 60ë°° í–¥ìƒ',
    'LSSL ëŒ€ë¹„ 30ë°° ì†ë„ í–¥ìƒ, 400ë°° ë©”ëª¨ë¦¬ ì ˆê°',
    'S4 ì´í›„ DSS, S4D, S5, H3, Hyena, Mamba ë“± í›„ì† SSM ì—°êµ¬ì˜ ê¸°ë°˜ ë§ˆë ¨',
  ],

  algorithms: [
    'HiPPO í–‰ë ¬ A ì´ˆê¸°í™”: HiPPO-LegS í–‰ë ¬ì˜ í•´ì„ì  í˜•íƒœë¡œ ìƒíƒœ ì „ì´ í–‰ë ¬ ì„¤ì •',
    'NPLR ë¶„í•´: A = VÎ›V* âˆ’ PQ^T, V ìœ ë‹ˆí„°ë¦¬, Î› ë³µì†Œ ëŒ€ê°, PÂ·Q ëž­í¬ r â‰¤ 2 ë²¡í„°',
    'DPLR ì¢Œí‘œ ë³€í™˜: Vë¥¼ í¡ìˆ˜í•˜ì—¬ Î› âˆ’ pq* í˜•íƒœë¡œ ë³€í™˜, ëª¨ë“  íŒŒë¼ë¯¸í„°ë¥¼ ë³µì†Œìˆ˜ ê³µê°„ìœ¼ë¡œ ë§¤í•‘',
    'Bilinear ì´ì‚°í™”: í•™ìŠµ ê°€ëŠ¥ Î”(ë¡œê·¸ ê³µê°„)ë¡œ ì—°ì†â†’ì´ì‚° ë³€í™˜, ì•ˆì •ì„± ë³´ì¡´',
    'ZOH ì´ì‚°í™”: Ä€ = exp(Î”A), BÌ„ = (Î”A)^{-1}(exp(Î”A) - I)Â·Î”B',
    'ìƒì„± í•¨ìˆ˜ ë‹¨ìœ„ê·¼ í‰ê°€: Lê°œ ë‹¨ìœ„ê·¼ì—ì„œ KÌ‚_L(Ï‰_j) ê³„ì‚° â†’ Woodbury + Cauchy',
    'ì—­FFT ì»¤ë„ ë³µì›: ì£¼íŒŒìˆ˜â†’ì‹œê°„ ë„ë©”ì¸ ì»¤ë„ KÌ„ âˆˆ â„^L ë³µì›',
    'FFT í•©ì„±ê³± (í•™ìŠµ ëª¨ë“œ): y = KÌ„ * uë¥¼ O(L log L)ì— ê³„ì‚°',
    'ìˆœí™˜ ì „ê°œ (ì¶”ë¡  ëª¨ë“œ): x_k = Ä€x_{k-1} + BÌ„u_k, y_k = CÌ„x_kë¡œ ìŠ¤í…ë‹¹ O(N)',
    'Cauchy ì»¤ë„: Ã•(N) ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ SSM ì»¤ë„ì˜ íš¨ìœ¨ì  í‰ê°€',
  ],

  key_equations: [
    {
      name: 'ì—°ì† ì‹œê°„ SSM',
      latex: "x'(t) = \\mathbf{A}\\,x(t) + \\mathbf{B}\\,u(t), \\quad y(t) = \\mathbf{C}\\,x(t) + \\mathbf{D}\\,u(t)",
      description: 'SSM ê¸°ë³¸ í˜•íƒœ. A âˆˆ â„^{NÃ—N} ìƒíƒœ ì „ì´, B âˆˆ â„^{NÃ—1} ìž…ë ¥, C âˆˆ â„^{1Ã—N} ì¶œë ¥, D âˆˆ â„ ìŠ¤í‚µ. Aì˜ HiPPO ì´ˆê¸°í™”ê°€ ìž¥ê±°ë¦¬ ì˜ì¡´ì„±ì˜ í•µì‹¬.',
    },
    {
      name: 'ìŒì„ í˜•(Bilinear) ì´ì‚°í™”',
      latex: '\\bar{\\mathbf{A}} = \\left(\\mathbf{I} - \\tfrac{\\Delta}{2}\\mathbf{A}\\right)^{-1}\\left(\\mathbf{I} + \\tfrac{\\Delta}{2}\\mathbf{A}\\right), \\quad \\bar{\\mathbf{B}} = \\left(\\mathbf{I} - \\tfrac{\\Delta}{2}\\mathbf{A}\\right)^{-1} \\Delta\\,\\mathbf{B}',
      description: 'ì‚¬ë‹¤ë¦¬ê¼´ ì ë¶„ì˜ 1ì°¨ PadÃ© ê·¼ì‚¬. ì—°ì† ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±(ì¢Œë°˜ë©´ â†’ ë‹¨ìœ„ì› ë‚´ë¶€)ì„ ë³´ì¡´.',
    },
    {
      name: 'ZOH ì´ì‚°í™”',
      latex: '\\bar{\\mathbf{A}} = \\exp(\\Delta\\,\\mathbf{A}), \\quad \\bar{\\mathbf{B}} = (\\Delta\\,\\mathbf{A})^{-1}(\\exp(\\Delta\\,\\mathbf{A}) - \\mathbf{I})\\cdot\\Delta\\,\\mathbf{B}',
      description: 'ìž…ë ¥ì´ ê° íƒ€ìž„ìŠ¤í… ë‚´ì—ì„œ ìƒìˆ˜ë¼ ê°€ì •. í–‰ë ¬ ì§€ìˆ˜ í•¨ìˆ˜ exp(Î”A)ë¡œ ì •í™•í•œ ì—°ì†â†’ì´ì‚° ë³€í™˜.',
    },
    {
      name: 'ì´ì‚° ì‹œê°„ ìˆœí™˜ (RNN í˜•íƒœ)',
      latex: 'x_k = \\bar{\\mathbf{A}}\\,x_{k-1} + \\bar{\\mathbf{B}}\\,u_k, \\quad y_k = \\bar{\\mathbf{C}}\\,x_k',
      description: 'ì¶”ë¡  ì‹œ ì´ í˜•íƒœë¡œ ìŠ¤í…ë‹¹ O(N) ìžê¸°íšŒê·€ ìƒì„±. Transformerë³´ë‹¤ 60ë°° ë¹ ë¥¸ ìƒì„± ì†ë„.',
    },
    {
      name: 'í•©ì„±ê³± ì»¤ë„',
      latex: '\\bar{\\mathbf{K}} = \\left(\\bar{\\mathbf{C}}\\bar{\\mathbf{B}},\\; \\bar{\\mathbf{C}}\\bar{\\mathbf{A}}\\bar{\\mathbf{B}},\\; \\ldots,\\; \\bar{\\mathbf{C}}\\bar{\\mathbf{A}}^{L-1}\\bar{\\mathbf{B}}\\right) \\in \\mathbb{R}^L',
      description: 'ì´ˆê¸° ìƒíƒœ 0ì—ì„œ ì´ì‚° ìˆœí™˜ì„ ì „ê°œí•˜ë©´ ì¶œë ¥ì€ ìž…ë ¥ê³¼ì˜ í•©ì„±ê³±. ì‹œìŠ¤í…œì˜ ìž„íŽ„ìŠ¤ ì‘ë‹µì— í•´ë‹¹.',
    },
    {
      name: 'FFT ê¸°ë°˜ í•©ì„±ê³± ì¶œë ¥',
      latex: 'y = \\bar{\\mathbf{K}} * u = \\text{iFFT}\\!\\left(\\text{FFT}(\\bar{\\mathbf{K}}) \\odot \\text{FFT}(u)\\right)',
      description: 'í•©ì„±ê³± ì •ë¦¬ë¡œ O(L log L) ë³‘ë ¬ ê³„ì‚°. ì´ê²ƒì´ S4 í•™ìŠµ ëª¨ë“œì˜ í•µì‹¬.',
    },
    {
      name: 'ì ˆë‹¨ ìƒì„± í•¨ìˆ˜ (z-ë³€í™˜)',
      latex: '\\hat{\\mathcal{K}}_L(z) = \\sum_{i=0}^{L-1} \\bar{\\mathbf{C}}\\,\\bar{\\mathbf{A}}^i\\,\\bar{\\mathbf{B}}\\, z^i = \\tilde{\\mathbf{C}}\\left(\\mathbf{I} - \\bar{\\mathbf{A}}\\,z\\right)^{-1}\\bar{\\mathbf{B}}',
      description: 'ì»¤ë„ì˜ z-ë³€í™˜. CÌƒ = CÌ„(I âˆ’ Ä€^L)ì€ ì ˆë‹¨ ë³´ì •. ë‹¨ìœ„ê·¼ì—ì„œ í‰ê°€ í›„ ì—­FFTë¡œ ì»¤ë„ ë³µì›.',
    },
    {
      name: 'NPLR ë¶„í•´',
      latex: '\\mathbf{A} = \\mathbf{V}\\mathbf{\\Lambda}\\mathbf{V}^* - \\mathbf{P}\\mathbf{Q}^T',
      description: 'S4ì˜ í•µì‹¬ êµ¬ì¡°. ëª¨ë“  HiPPO í–‰ë ¬ì´ NPLR í‘œí˜„ì„ ê°€ì§ì„ ì¦ëª…. V ìœ ë‹ˆí„°ë¦¬, Î› ëŒ€ê°, PÂ·Q ì €ëž­í¬(r â‰¤ 2).',
    },
    {
      name: 'DPLR í˜•íƒœ',
      latex: '\\mathbf{A} = \\mathbf{\\Lambda} - \\mathbf{p}\\mathbf{q}^*, \\quad \\mathbf{\\Lambda}\\in\\mathbb{C}^{N\\times N}_{\\text{diag}},\\; \\mathbf{p},\\mathbf{q},\\mathbf{B},\\mathbf{C}\\in\\mathbb{C}^{N}',
      description: 'Vë¥¼ í¡ìˆ˜í•œ ìž‘ì—… ê³µê°„. ëª¨ë“  íŒŒë¼ë¯¸í„°ê°€ ë³µì†Œìˆ˜. Woodbury í•­ë“±ì‹ ì ìš© ê°€ëŠ¥.',
    },
    {
      name: 'Woodbury í•­ë“±ì‹',
      latex: '(\\mathbf{\\Lambda} + \\mathbf{p}\\mathbf{q}^*)^{-1} = \\mathbf{\\Lambda}^{-1} - \\mathbf{\\Lambda}^{-1}\\mathbf{p}\\left(1 + \\mathbf{q}^*\\mathbf{\\Lambda}^{-1}\\mathbf{p}\\right)^{-1}\\mathbf{q}^*\\mathbf{\\Lambda}^{-1}',
      description: 'ëž­í¬-1 ì„­ë™ ëŒ€ê° í–‰ë ¬ì˜ ì—­ì„ íš¨ìœ¨ì ìœ¼ë¡œ ê³„ì‚°. NÃ—N ì—­í–‰ë ¬ â†’ ëŒ€ê° ì—­ + ìŠ¤ì¹¼ë¼ ë³´ì •.',
    },
    {
      name: 'Cauchy ì»¤ë„ ê³µì‹',
      latex: '\\hat{\\mathcal{K}}_{\\mathbf{\\Lambda}}(z) = c(z)\\sum_{i=0}^{N-1}\\frac{\\tilde{C}_i\\, B_i}{g(z) - \\Lambda_i}',
      description: 'ëŒ€ê° Î›ì— ëŒ€í•œ ìƒì„± í•¨ìˆ˜ê°€ Cauchy ì»¤ë„ í˜•íƒœë¡œ í™˜ì›. O(N log N) ë˜ëŠ” O(N)ì— ê³„ì‚° ê°€ëŠ¥.',
    },
    {
      name: 'DPLR ìƒì„± í•¨ìˆ˜ (ìµœì¢…)',
      latex: '\\hat{\\mathcal{K}}_{\\text{DPLR}}(z) = c(z)\\!\\left[k_{z,\\Lambda}(\\tilde{\\mathbf{C}},\\mathbf{B}) - k_{z,\\Lambda}(\\tilde{\\mathbf{C}},\\mathbf{p})\\!\\left(1 + k_{z,\\Lambda}(\\mathbf{q}^*,\\mathbf{p})\\right)^{-1}\\!k_{z,\\Lambda}(\\mathbf{q}^*,\\mathbf{B})\\right]',
      description: 'Woodbury ì ìš© í›„ 4ê°œ Cauchy ì»¤ë„ ê³±ìœ¼ë¡œ ë¶„í•´. Lê°œ ë‹¨ìœ„ê·¼ì—ì„œ í‰ê°€ í›„ ì—­FFT â†’ ì „ì²´ Ã•(N+L). S4ì˜ ê³„ì‚°ì  í•µì‹¬.',
    },
  ],

  architecture_detail: `## ì „ì²´ ê³„ì‚° íŒŒì´í”„ë¼ì¸

S4ëŠ” ìž…ë ¥ ì‹œí€€ìŠ¤ u = (u_0, ..., u_{L-1})ë¥¼ ë°›ì•„ ì¶œë ¥ ì‹œí€€ìŠ¤ yë¥¼ ìƒì„±í•˜ë©°, Nì°¨ì› ìž ìž¬ ìƒíƒœ xë¥¼ ìœ ì§€í•œë‹¤. íŒŒì´í”„ë¼ì¸: (1) ì—°ì† SSM ì •ì˜, (2) ì´ì‚°í™”, (3) ì»¤ë„ ê³„ì‚°, (4) í•©ì„±ê³± ë˜ëŠ” ìˆœí™˜ ì ìš©.

## í•™ìŠµ ëª¨ë“œ: í•©ì„±ê³±

í•™ìŠµ ì‹œ ì „ì²´ ìž…ë ¥ì´ ì£¼ì–´ì§€ë¯€ë¡œ í•©ì„±ê³± í‘œí˜„ì„ ì‚¬ìš©í•œë‹¤. í•™ìŠµ ê°€ëŠ¥ íŒŒë¼ë¯¸í„° (Î›, P, Q, B, C, Î”)ë¡œë¶€í„° DPLR ì´ì‚° SSM í–‰ë ¬ì„ ê³„ì‚°í•˜ê³ , ìƒì„±í•¨ìˆ˜ì˜ ë‹¨ìœ„ê·¼ í‰ê°€ë¡œ Ã•(N+L)ì— ì»¤ë„ KÌ„ë¥¼ êµ¬í•œë‹¤. ìµœì¢… ì¶œë ¥ y = KÌ„ * uë¥¼ FFTë¡œ O(L log L)ì— ê³„ì‚°.

ì»¤ë„ ìƒì„± ê³¼ì •: Lê°œ ë‹¨ìœ„ê·¼ Ï‰_j = exp(2Ï€ij/L)ì—ì„œ KÌ‚_L(Ï‰_j)ë¥¼ í‰ê°€ â†’ DPLR êµ¬ì¡°ë¡œ 4ê°œ Cauchy ì»¤ë„ ê³±ìœ¼ë¡œ í™˜ì› â†’ ê°ê° Ã•(N) â†’ Lê°œ í‰ê°€ì ì˜ ì—­FFT â†’ ì‹œê°„ ë„ë©”ì¸ ì»¤ë„ ë³µì›.

## ì¶”ë¡  ëª¨ë“œ: ìˆœí™˜

ìžê¸°íšŒê·€ ìƒì„± ì‹œ ì´ì‚° í–‰ë ¬ Ä€, BÌ„ë¥¼ í•œ ë²ˆ ê³„ì‚° í›„, x_k = Ä€x_{k-1} + BÌ„u_k, y_k = CÌ„x_k ìˆœí™˜ì„ ì‹¤í–‰. DPLRì—ì„œ Ä€ëŠ” ëŒ€ê°+ì €ëž­í¬ì´ë¯€ë¡œ O(N) í–‰ë ¬-ë²¡í„° ê³±.

## NPLR + Cauchyì˜ O(NÂ²L) â†’ Ã•(N+L) í™˜ì›

ì»¤ë„ ì§ì ‘ ê³„ì‚°ì€ O(NÂ²L). S4ì˜ í•´ê²°: (1) Aì˜ NPLR ë¶„í•´ â†’ DPLR ë³€í™˜, (2) ìƒì„±í•¨ìˆ˜ ë‹«ížŒ í˜•íƒœ, (3) Woodburyë¡œ NÃ—N ì—­í–‰ë ¬ â†’ ëŒ€ê° + ìŠ¤ì¹¼ë¼ ë³´ì •, (4) 4ê°œ Cauchy ì»¤ë„ ê³±, (5) Lê°œ í‰ê°€ì ì—ì„œ ê³„ì‚° í›„ ì—­FFT â†’ Ã•(N+L), O(N+L) ë©”ëª¨ë¦¬.

## HiPPO ì´ˆê¸°í™”ì˜ ì—­í• 

Aë¥¼ HiPPO-LegS í–‰ë ¬ë¡œ ì´ˆê¸°í™”í•˜ë©´ ìž…ë ¥ ì´ë ¥ì„ ë¥´ìž¥ë“œë¥´ ë‹¤í•­ì‹ìœ¼ë¡œ ìµœì  ì••ì¶•. ëžœë¤ ì´ˆê¸°í™” ëŒ€ë¹„ Sequential CIFAR-10ì—ì„œ 60%â†’91% ê·¹ì  ì°¨ì´. ì ì ˆí•œ A ì´ˆê¸°í™”ê°€ ìž¥ê±°ë¦¬ ì˜ì¡´ì„±ì— ê²°ì •ì .

## í•™ìŠµ ê°€ëŠ¥ íŒŒë¼ë¯¸í„°

Î› âˆˆ â„‚^N (ëŒ€ê° ê³ ìœ ê°’), P, Q âˆˆ â„‚^N (ì €ëž­í¬ ë³´ì •), B âˆˆ â„‚^N (ìž…ë ¥), C âˆˆ â„‚^N (ì¶œë ¥), log Î” âˆˆ â„ (ìŠ¤í… ì‚¬ì´ì¦ˆ), D âˆˆ â„ (ìŠ¤í‚µ). ì´ O(N) íŒŒë¼ë¯¸í„°.

## ë‹¤ì¤‘ ë ˆì´ì–´ ì•„í‚¤í…ì²˜

Hê°œ ë…ë¦½ SSMì„ ë³‘ë ¬ ìš´ìš©(depthwise-separable). ë¸”ë¡ ëŒ€ê° êµ¬ì¡°ë¡œ ë³‘ë ¬ ê³„ì‚°. SSM í›„ position-wise ì„ í˜• + GELUë¡œ ì±„ë„ í˜¼í•©. ê¹Šì´ 6~12 ë ˆì´ì–´ë¡œ ë³µìž¡í•œ íŒ¨í„´ í•™ìŠµ.

## í•´ìƒë„ ì ì‘ via Î”

ì—°ì† ì‹œê°„ ëª¨ë¸ ê³ ìœ ì˜ ìž¥ì : Î”ë¥¼ ë³€ê²½í•˜ë©´ ë‹¤ë¥¸ ìƒ˜í”Œë§ ë ˆì´íŠ¸ì— ìžë™ ì ì‘. Î” ì¶•ì†Œ â†’ ì»¤ë„ í™•ìž¥(ê³ í•´ìƒë„), Î” í™•ëŒ€ â†’ ì»¤ë„ ì••ì¶•(ì €í•´ìƒë„). ì´ì‚° ëª¨ë¸ì—ì„œëŠ” ë¶ˆê°€ëŠ¥í•œ íŠ¹ì„±.`,

  prerequisites: [
    'ì„ í˜•ëŒ€ìˆ˜: ê³ ìœ ê°’ ë¶„í•´, ìœ ë‹ˆí„°ë¦¬ í–‰ë ¬, ëŒ€ê°í™”, í–‰ë ¬ ì§€ìˆ˜ í•¨ìˆ˜',
    'ìƒíƒœ ê³µê°„ ëª¨ë¸: ì—°ì† ì‹œê°„ LTI ì‹œìŠ¤í…œ, ì „ë‹¬ í•¨ìˆ˜, ìž„íŽ„ìŠ¤ ì‘ë‹µ',
    'ì´ì‚°í™” ì´ë¡ : ìŒì„ í˜• ë³€í™˜(Tustin), ì˜ì°¨ í™€ë“œ(ZOH), ìƒ˜í”Œë§ ì´ë¡ ',
    'ì‹ í˜¸ ì²˜ë¦¬: FFT/ì—­FFT, í•©ì„±ê³± ì •ë¦¬, z-ë³€í™˜ ê¸°ì´ˆ',
    'ìˆ˜ì¹˜í•´ì„: Cauchy í–‰ë ¬, Woodbury í•­ë“±ì‹, PadÃ© ê·¼ì‚¬',
    'ë”¥ëŸ¬ë‹: RNN/CNN í•™ìŠµ, ìžê¸°íšŒê·€ ìƒì„±, ì—­ì „íŒŒ',
    'ì§êµ ë‹¤í•­ì‹: ë¥´ìž¥ë“œë¥´ ë‹¤í•­ì‹ ê¸°ë³¸ ì„±ì§ˆ (HiPPO ì´í•´)',
    'ë³µì†Œìˆ˜ í•´ì„: ë³µì†Œ í–‰ë ¬, ì—ë¥´ë¯¸íŠ¸ ì „ì¹˜(V*), ë³µì†Œ ê³ ìœ ê°’',
  ],

  learning_objectives: [
    'SSMì˜ ì„¸ ê°€ì§€ ë™ì¹˜ í‘œí˜„(ì—°ì†/ì´ì‚° ìˆœí™˜/í•©ì„±ê³±)ì„ ìœ ë„í•˜ê³  ê° í‘œí˜„ì˜ ìž¥ë‹¨ì ì„ ë¹„êµí•  ìˆ˜ ìžˆë‹¤',
    'Bilinear ì´ì‚°í™”ì™€ ZOH ì´ì‚°í™”ì˜ ìˆ˜ì‹ì„ ìœ ë„í•˜ê³  ì•ˆì •ì„± ë³´ì¡´ íŠ¹ì„±ì„ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'í•©ì„±ê³± ì»¤ë„ KÌ„ë¥¼ ì´ì‚° ìˆœí™˜ì˜ ì „ê°œë¡œë¶€í„° ìœ ë„í•˜ê³  ì „ì—­ í•©ì„±ê³±ì¸ ì´ìœ ë¥¼ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'í•™ìŠµ ëª¨ë“œ(í•©ì„±ê³±)ì™€ ì¶”ë¡  ëª¨ë“œ(ìˆœí™˜)ì˜ ì „í™˜ì´ ê°€ëŠ¥í•œ ìˆ˜í•™ì  ì´ìœ ì™€ ê° ëª¨ë“œì˜ ë³µìž¡ë„ë¥¼ ë¹„êµí•  ìˆ˜ ìžˆë‹¤',
    'NPLR ë¶„í•´ì˜ ì •ì˜ì™€ HiPPO í–‰ë ¬ì´ NPLR êµ¬ì¡°ë¥¼ ê°€ì§€ëŠ” ì´ìœ ë¥¼ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'DPLRì—ì„œ Woodbury + Cauchy ì»¤ë„ë¡œì˜ í™˜ì› ê³¼ì •ì„ ìœ ë„í•  ìˆ˜ ìžˆë‹¤',
    'HiPPO ì´ˆê¸°í™”ì˜ ê²°ì •ì  ì—­í• ì„ ëžœë¤ ì´ˆê¸°í™”ì™€ì˜ ì„±ëŠ¥ ì°¨ì´ë¡œ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'Î”ì˜ ì—­í• ê³¼ í•´ìƒë„ ì ì‘ì˜ ì›ë¦¬ë¥¼ ì—°ì† ì‹œê°„ ê´€ì ì—ì„œ ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'S4ê°€ Path-Xë¥¼ ìµœì´ˆ í•´ê²°í•œ ê¸°ìˆ ì  ì´ìœ ë¥¼ ì¢…í•© ì„¤ëª…í•  ìˆ˜ ìžˆë‹¤',
    'S4 ì´í›„ DSS, S4Dì˜ ìˆœìˆ˜ ëŒ€ê° íŒŒë¼ë¯¸í„°í™”ê°€ ê°€ëŠ¥í•´ì§„ ì´ìœ ë¥¼ ë¹„êµí•  ìˆ˜ ìžˆë‹¤',
  ],

  self_check_questions: [
    'SSMì—ì„œ í–‰ë ¬ Aì˜ ì´ˆê¸°í™”ê°€ ì‹œí€€ìŠ¤ ëª¨ë¸ë§ ì„±ëŠ¥ì— ê²°ì •ì ì¸ ì´ìœ ëŠ”?',
    'ì»¤ë„ KÌ„ = (CBÌ„, CÄ€BÌ„, ..., CÄ€^{L-1}BÌ„)ë¥¼ ì§ì ‘ ê³„ì‚°í•˜ë©´ ì™œ O(NÂ²L)ì¸ê°€? ë³‘ëª©ì€?',
    'Bilinear ì´ì‚°í™” Ä€ = (I âˆ’ Î”/2Â·A)^{-1}(I + Î”/2Â·A)ëŠ” ì–´ë–¤ ìˆ˜ì¹˜ ì ë¶„ë²•ì˜ ê·¼ì‚¬ì´ë©° ì•ˆì •ì„±ì„ ë³´ì¡´í•˜ëŠ” ì´ìœ ëŠ”?',
    'S4ê°€ í•™ìŠµ ì‹œ í•©ì„±ê³±, ì¶”ë¡  ì‹œ ìˆœí™˜ì„ ì‚¬ìš©í•˜ëŠ” ì´ìœ ë¥¼ ê°ê°ì˜ ê³„ì‚°ì  ì´ì ìœ¼ë¡œ ì„¤ëª…í•˜ì‹œì˜¤.',
    'NPLRì—ì„œ Vê°€ ìœ ë‹ˆí„°ë¦¬ë¼ëŠ” ì¡°ê±´ì´ ì™œ ì¤‘ìš”í•œê°€?',
    'Woodburyë¥¼ DPLR ë ˆì¡¸ë²¤íŠ¸ì— ì ìš©í•˜ë©´ ì™œ Cauchy ì»¤ë„ì´ ë‚˜íƒ€ë‚˜ëŠ”ì§€ ìœ ë„í•˜ì‹œì˜¤.',
    'HiPPO-LegS ì´ˆê¸°í™” S4 vs ëžœë¤ ì´ˆê¸°í™” SSMì˜ Sequential CIFAR-10 ì„±ëŠ¥ ì°¨ì´(91% vs 60%) ì›ì¸ì€?',
    'Î”ë¥¼ log ê³µê°„ì—ì„œ í•™ìŠµí•˜ëŠ” ì´ìœ ëŠ”? Î” í¬ê¸°ê°€ ì‹œê°„ì  í•´ìƒë„ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì€?',
    'S4ê°€ Path-X(16K)ë¥¼ í•´ê²°í•˜ê³  Transformerê°€ ì‹¤íŒ¨í•œ ê¸°ìˆ ì  ì´ìœ ë¥¼ ì„¤ëª…í•˜ì‹œì˜¤.',
    'S4 ì´í›„ DSS, S4Dê°€ ìˆœìˆ˜ ëŒ€ê° íŒŒë¼ë¯¸í„°í™”ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ S4ì˜ NPLRì´ ì—¬ì „ížˆ í•„ìš”í•œ ê²½ìš°ëŠ”?',
  ],
};

// â”€â”€ Mamba enrichment â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Read from the JSON file created by the research agent
const mambaJsonPath = path.join(ROOT, 'docs', 'paper-content', 'mamba-2312.00752-study-content.json');
let MAMBA_UPDATE;

if (fs.existsSync(mambaJsonPath)) {
  const mambaData = JSON.parse(fs.readFileSync(mambaJsonPath, 'utf8'));
  MAMBA_UPDATE = {
    abstract: mambaData.abstract,
    key_contributions: mambaData.key_contributions,
    algorithms: mambaData.algorithms,
    key_equations: mambaData.key_equations,
    architecture_detail: mambaData.architecture_detail,
    prerequisites: mambaData.prerequisites,
    learning_objectives: mambaData.learning_objectives,
    self_check_questions: mambaData.self_check_questions,
    // Keep category as 'other' (SSM papers)
    tags: ['ssm', 'state_space_model', 'sequence_modeling', 'mamba', 'selective_ssm', 'hardware_aware', 'linear_time', 'language_model', 'parallel_scan', 'transformer_alternative'],
  };
} else {
  console.error('âŒ Mamba JSON íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', mambaJsonPath);
  process.exit(1);
}

// â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function main() {
  console.log('ðŸš€ SSM ë…¼ë¬¸ 3ê°œ ë‚´ìš© ë³´ê°• ì‹œìž‘...\n');

  const updates = [
    { id: IDS.HIPPO, name: 'HiPPO', data: HIPPO_UPDATE },
    { id: IDS.S4, name: 'S4', data: S4_UPDATE },
    { id: IDS.MAMBA, name: 'Mamba', data: MAMBA_UPDATE },
  ];

  for (const { id, name, data } of updates) {
    console.log(`ðŸ“ ${name} ì—…ë°ì´íŠ¸ ì¤‘...`);

    const { error } = await supabase
      .from('papers')
      .update(data)
      .eq('id', id);

    if (error) {
      console.error(`  âŒ ${name} ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, error.message);
    } else {
      const eqCount = data.key_equations?.length ?? '?';
      const contribCount = data.key_contributions?.length ?? '?';
      const qCount = data.self_check_questions?.length ?? '?';
      console.log(`  âœ… ${name}: abstract ${data.abstract?.length ?? 0}ìž, equations ${eqCount}ê°œ, contributions ${contribCount}ê°œ, questions ${qCount}ê°œ`);
    }
  }

  console.log('\nðŸŽ‰ SSM ë…¼ë¬¸ 3ê°œ ë‚´ìš© ë³´ê°• ì™„ë£Œ!');
}

main().catch(console.error);
